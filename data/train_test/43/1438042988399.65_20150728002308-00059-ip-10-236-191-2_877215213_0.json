{
    "relation": [
        [
            "Force Protocol Encryption client setting",
            "No",
            "No",
            "No",
            "Yes",
            "Yes",
            "Yes",
            "Yes"
        ],
        [
            "Trust Server Certificate client setting",
            "N/A",
            "N/A",
            "N/A",
            "No",
            "Yes",
            "Yes",
            "Yes"
        ],
        [
            "Connection string/connection attribute Encrypt/Use Encryption for Data",
            "No (default)",
            "Yes",
            "Yes",
            "Ignored",
            "No (default)",
            "Yes",
            "Yes"
        ],
        [
            "Connection string/connection attribute Trust Server Certificate",
            "Ignored",
            "No (default)",
            "Yes",
            "Ignored",
            "Ignored",
            "No (default)",
            "Yes"
        ],
        [
            "Result",
            "No encryption occurs.",
            "Encryption occurs only if there is a verifiable server certificate, otherwise the connection attempt fails.",
            "Encryption always occurs, but may use a self-signed server certificate.",
            "Encryption occurs only if there is a verifiable server certificate, otherwise the connection attempt fails.",
            "Encryption always occurs, but may use a self-signed server certificate.",
            "Encryption occurs only if there is a verifiable server certificate, otherwise the connection attempt fails.",
            "Encryption occurs only if there is a verifiable server certificate, otherwise the connection attempt fails."
        ]
    ],
    "pageTitle": "Using Encryption Without Validation",
    "title": "",
    "url": "https://msdn.microsoft.com/en-us/library/ms131691(v=sql.90).aspx",
    "hasHeader": true,
    "headerPosition": "FIRST_ROW",
    "tableType": "RELATION",
    "tableNum": 0,
    "s3Link": "common-crawl/crawl-data/CC-MAIN-2015-32/segments/1438042988399.65/warc/CC-MAIN-20150728002308-00059-ip-10-236-191-2.ec2.internal.warc.gz",
    "recordEndOffset": 877228915,
    "recordOffset": 877215213,
    "tableOrientation": "HORIZONTAL",
    "TableContextTimeStampAfterTable": "{21721=SQL Server 2005 always encrypts network packets associated with logging in. If no certificate has been provisioned on the server when it starts up, SQL Server generates a self-signed certificate which is used to encrypt login packets.}",
    "textBeforeTable": "Applications may also use the \"TrustServerCertificate\" keyword or its associated connection attribute to guarantee that encryption takes place. Application settings never reduce the level of security set by SQL Server Client Configuration Manager, but may strengthen it. For example, if Force Protocol Encryption is not set for the client, an application may request encryption itself. To guarantee encryption even when a server certificate has not been provisioned, an application may request encryption and \"TrustServerCertificate\". However, if \"TrustServerCertificate\" is not enabled in the client configuration, a provisioned server certificate is still required. The following table describes all cases: To enable encryption to be used when a certificate has not been provisioned on the server, SQL Server Configuration Manager can be used to set both the Force Protocol Encryption and the Trust Server Certificate options. In this case, encryption will use a self-signed server certificate without validation if no verifiable certificate has been provisioned on the server. For information about connection string keywords, see Using Connection String Keywords with SQL Native Client. Applications may also request encryption of all network traffic by using connection string keywords or connection properties. The keywords are \"Encrypt\" for ODBC and OLE DB when using a provider string with IDbInitialize::Initialize, or \"Use Encryption for Data\" for ADO and OLE DB when using an initialization string with IDataInitialize. This may also be configured by SQL Server Configuration Manager using the Force Protocol Encryption option. By default, encryption of all network traffic for a connection requires",
    "textAfterTable": "SQL Native Client OLE DB Provider The SQL Native Client OLE DB provider supports encryption without validation through the addition of the SSPROP_INIT_TRUST_SERVER_CERTIFICATE data source initialization property, which is implemented in the DBPROPSET_SQLSERVERDBINIT property set. In addition, a new connection string keyword, \"TrustServerCertificate\", as been added. It accepts yes or no values; no is the default. When using service components, it accepts true or false values; false is the default. For more information about enhancements made to the DBPROPSET_SQLSERVERDBINIT property set, see Initialization and Authorization Properties. SQL Native Client ODBC Driver The SQL Native Client ODBC driver supports encryption without validation through additions to the SQLSetConnectAttr and SQLGetConnectAttr functions. SQL_COPT_SS_ TRUST_SERVER_CERTIFICATE has been added to accept either SQL_TRUST_SERVER_CERTIFICATE_YES or SQL_TRUST_SERVER_CERTIFICATE_NO, with SQL_TRUST_SERVER_CERTIFICATE_NO being the default. In addition, a new connection string keyword, \"TrustServerCertificate\", has been added. It accepts yes or no values; \"no\" is the default. See Also Other Resources Features of SQL Native Client Help and Information Getting SQL Server 2005 Assistance",
    "hasKeyColumn": false,
    "keyColumnIndex": -1,
    "headerRowIndex": 0
}